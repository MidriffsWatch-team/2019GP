---
title: "report_figures_juliette"
author: "Juliette Verstaen"
date: "2/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, include=FALSE, message=FALSE}
library(ggplot2)
library(here)
library(plotly)
library(tidyverse)
library(gganimate)
library(ggrepel)
library(ggridges)
library(ggpubr)
library(gridExtra)
library(grid)
```

#importing the dataset only looking at 2015-2050
```{r}
res<-read.csv(here::here("Scenarios", "PatchModel_size.csv"))%>%
  filter(Year <= 2050 & Adjusted== "MT")
bmsy<- expression(paste(B/B[MSY]))
fmsy <- expression(paste(F/F[MSY]))

```

Summing up cummulative biomass and pv of all genuses OA
```{r}

circle<- res%>%
  filter(Total_Area == "5%") %>%
  group_by(Status, Adjusted)%>%
  summarize(Biomass_est=sum(Biomass_est), 
            Catch_est=sum(Catch_est), 
            PV_est=sum(PV_est))
circle$Status<- as.factor(circle$Status)

#bio_pv_2035 <- res%>%
#  filter(Total_Area == "5%")%>%
#  filter(Year <= "2035")%>%
#  group_by(Status, Adjusted)%>%
#  summarize(Biomass_est=sum(Biomass_est), 
#            Catch_est=sum(Catch_est), 
#            PV_est=sum(PV_est))
#bio_pv_2035$Status<- as.factor(bio_pv_2035$Status)


```


```{r}

circle_graph <- ggplot(circle) +
  geom_point(aes(x= Biomass_est, y= PV_est, size=Catch_est, color = Status), shape = 21)+
  scale_size_continuous(range = c(11, 25)) +
  annotate(geom="text", x=997231.5, y=401138707, label="260K MT",
              color="black") +
  annotate(geom="text", x=1042283.9, y=383680819, label="250K MT",
              color="black")+
  annotate(geom="text", x=1038810.0, y=386966389, label="252K MT",
              color="black")+
  annotate(geom="text", x=1033346.3, y=392087169, label="254K MT",
              color="black")+
  annotate(geom="text", x=1025636.3, y=397640546, label="256K MT",
              color="black")+
  xlim(990000, 1045000)+
  ylim(383000000, 404000000)+
  theme_classic()+
  ggtitle("Aggregate Regional Affects")
  

circle_graph

#ggsave("agg_circles.jpg", width=7, height=5, dpi=300)

```

Summing up cummulative biomass and pv of all genuses F= FMSY
```{r}

library(dplyr)

fmsy<- read.csv(here::here("Scenarios", "PatchModel_FMSY.csv"))%>%
  filter(Adjusted=="MT")


circle_OA<- fmsy%>%
  filter(Total_Area == "5%") %>%
  group_by(Status) %>%
  summarize(Biomass_est=sum(Biomass_est), 
            Catch_est=sum(Catch_est), 
            PV_est=sum(PV_est))

circle_OA$Status<- as.factor(circle_OA$Status)


```







Graphs seperated out by implmentation date (too similar to do all on one graph)
y axis= year; y-axis = biomass; size= catch, color = money made
**These are interesting because you can see the delayed effect of fishing pressure (with catch and increase profits) after the biomass spike and how the fishing pressure contines to be the same even though biomass decreases and then they bascially crash the fishery

```{r}

library(dplyr)

linepoint <- res %>%
    filter(Total_Area == "5%") %>%
  group_by(Year, Status, Adjusted)%>%
  summarize(Biomass_est=sum(Biomass_est), 
            Catch_est=sum(Catch_est), 
            PV_est=sum(PV_est))
linepoint$Status<- as.factor(linepoint$Status)
  

Genus_ts <- read_csv("data/Genus_ts.csv")

historic <- Genus_ts %>%
  filter(Adjusted == "MT") %>%
  filter(year>="2005") %>%
  filter(year != "2015") %>%
  group_by(year) %>%
  summarize(catch=sum(catch),
            b=sum(b))

colnames(historic) <- c("Year", "Catch_est", "Biomass_est")

initial <-linepoint %>%
  filter(Status== "0") 
initial <- full_join(historic, initial, by=c("Year", "Biomass_est", "Catch_est"))

second <- filter(linepoint, Status == "2015")
second <- full_join(historic, second, by=c("Year", "Biomass_est", "Catch_est"))

third <- filter(linepoint, Status == "2020")
third <- full_join(historic, third, by=c("Year", "Biomass_est", "Catch_est"))

fourth <- filter(linepoint, Status == "2025")
fourth <- full_join(historic, fourth, by=c("Year", "Biomass_est", "Catch_est"))

fifth <- filter(linepoint, Status == "2030")
fifth <- full_join(historic, fifth, by=c("Year", "Biomass_est", "Catch_est"))

initial_graph <- ggplot(initial,aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point()+
  ggtitle("BAU")

second_graph <- ggplot(second,aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point()+
  ggtitle("Implement 2015")

third_graph <- ggplot(third,aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point()+
  ggtitle("Implement 2020")

fourth_graph <- ggplot(fourth,aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point()+
  ggtitle("Implement 2025")

fifth_graph <- ggplot(fifth,aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point()+
  ggtitle("Implement 2030")

all<-ggarrange(initial_graph, second_graph, third_graph, fourth_graph, fifth_graph, nrow=3, ncol=2, common.legend = TRUE, legend="bottom")
all
ggsave("biomass_time.jpg", width=10, height=12, dpi=300)
```









Juliette Notebook:
```{r}

linepoint <- res %>%
    filter(Total_Area == "5%") %>%
  group_by(Year, Status, Adjusted)%>%
  summarize(Biomass_est=sum(Biomass_est), 
            Catch_est=sum(Catch_est), 
            PV_est=sum(PV_est))
linepoint$Status<- as.factor(linepoint$Status)
  
initial <-filter(linepoint, Status== "0")
second <- filter(linepoint, Status == "2015")
third <- filter(linepoint, Status == "2020")
fourth <- filter(linepoint, Status == "2025")
fifth <- filter(linepoint, Status == "2030")

linepoint_graph <- ggplot(initial,aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point()+
  geom_point(data= second, aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point(data = third, aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point(data = fourth, aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point(data = fifth, aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))
  
linepoint_graph    
  
linepoint_graph_2 <- ggplot(linepoint,aes(x= Year, y = Biomass_est, colour = PV_est, size= Catch_est))+
  geom_point(data=linepoint[linepoint$Status =="0", ])+
  geom_point(data=linepoint[linepoint$Status =="2015", ])+
  geom_point(data=linepoint[linepoint$Status =="2020", ])+
  geom_point(data=linepoint[linepoint$Status =="2025", ])+
  geom_point(data=linepoint[linepoint$Status =="2030", ])

linepoint_graph_2



  
 
```
