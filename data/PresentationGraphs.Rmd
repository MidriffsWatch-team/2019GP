---
title: "Presentation Graphs"
author: "Seleni Cruz"
date: "January 16, 2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE, message=FALSE, echo=FALSE}
library(dplyr)
library(here)
library(tidyverse)
library(ggplot2)
library(plotly)
```


```{r, echo=FALSE, message=FALSE, fig.width=8, fig.height=12}
Genus_patchmodel <- read.csv(here::here("data", "merged_2D_output.csv"))%>%
  filter(Adjusted=="MT")

fishing <-ggplot(Genus_patchmodel, aes(x=Year, y=Fishing_est, color=Status))+
  geom_line()+
  labs(x="Year", y="Fishing effort", title="Fishing effort")+
  theme_classic()+
  scale_x_continuous(expand=c(0,0))+
  scale_y_continuous(expand=c(0,0))

fishing<- fishing+
   facet_wrap(~ Name, scales = "free_y", ncol=2)
ggplotly(fishing)


Biomass <-ggplot(Genus_patchmodel, aes(x=Year, y=Biomass_est, color= Status))+
  geom_line()+
  labs(x="Year", y="Biomass (MT)", title="Biomass")+
  theme_classic()+
  scale_x_continuous(expand=c(0,0))+
  scale_y_continuous(expand=c(0,0))

Biomass<- Biomass+
   facet_wrap(~ Name, scales = "free_y", ncol=2)
ggplotly(Biomass)

catch <-ggplot(Genus_patchmodel, aes(x=Year, y=Catch_est, color= Status))+
  geom_line()+
  labs(x="Year", y="Catch (MT)", title="Catch")+
  theme_classic()+
  scale_x_continuous(expand=c(0,0))+
  scale_y_continuous(expand=c(0,0))

catch<- catch+
   facet_wrap(~ Name, scales = "free_y", ncol=2)
ggplotly(catch)

```



```{r, include=FALSE, message=FALSE, echo= FALSE}
Genus_patchmodel <- read.csv(here::here("data", "merged_2D_output0.1.csv"))
#Genus_patchmodel[is.na(Genus_patchmodel)] <- 0
cummulative<- Genus_patchmodel%>%
  group_by(Status, Adjusted, Year)%>%
  summarize(Biomass_est=sum(Biomass_est), 
            Biomass_lo=sum(Biomass_lo), 
            Biomass_hi=sum(Biomass_hi), 
            Catch_est=sum(Catch_est),
            Catch_lo=sum(Catch_lo), 
            Catch_hi=sum(Catch_hi))
            #Revenue_est = sum(Revenue_est), 
            #Revenue_lo= sum(Revenue_lo), 
            #Revenue_hi= sum(Revenue_hi))

cummulative<-cummulative[-c(13:14, 87:88, 161:162, 235:236),]


Totals<- Genus_patchmodel%>%
  group_by(Status, Adjusted)%>%
  summarize(Biomass_est=sum(Biomass_est), 
            Biomass_lo=sum(Biomass_lo), 
            Biomass_hi=sum(Biomass_hi), 
            Catch_est=sum(Catch_est),
            Catch_lo=sum(Catch_lo), 
            Catch_hi=sum(Catch_hi)) 
            #Revenue = sum(Revenue_est), 
            #Revenue_lo= sum(Revenue_lo), 
            #Revenue_hi= sum(Revenue_hi))
         
```

```{r, echo=FALSE, message=FALSE}

biomass<- ggplot(cummulative, aes(x=Year, y=Biomass_est, color=Status))+
  geom_line(size=1)+
  labs(x="Year", y="Biomass (metric tons)", title="Cummulative Biomass")+
  #scale_colour_manual(values = c("#40b8d0", "#b2d183")) +
  theme_classic()+
   theme(axis.title.y = element_text(vjust=3))+
  scale_x_continuous(expand=c(0,0))+
  scale_y_continuous(expand=c(0,0))+
  theme(legend.title=element_blank())

biomass<- biomass+
   facet_wrap(~ Adjusted, scales = "free_y", ncol=2)
  
ggplotly(biomass)

catch<- ggplot(cummulative, aes(x=Year, y=Catch_est, color=Status))+
  geom_line(size=1)+
  labs(x="Year", y="Catch (metric tons)", title="Cummulative Catch")+
  #scale_colour_manual(values = c("#40b8d0", "#b2d183")) +
  theme_classic()+
   theme(axis.title.y = element_text(vjust=3))+
  scale_x_continuous(expand=c(0,0))+
  scale_y_continuous(expand=c(0,0))+
  theme(legend.title=element_blank())

catch<- catch+
   facet_wrap(~ Adjusted, scales = "free_y", ncol=2)
  
ggplotly(catch)


#revenue<- ggplot(cummulative, aes(x=Year, y=Revenue_est, color=Status))+
 # geom_line(size=1)+
  #labs(x="Year", y="Revenue (USD)", title="Cummulative Revenue (profit-cost)")+
  #scale_colour_manual(values = c("#40b8d0", "#b2d183")) +
  #theme_classic()+
   #theme(axis.title.y = element_text(vjust=3))+
  #scale_x_continuous(expand=c(0,0))+
  #scale_y_continuous(expand=c(0,0))+
  #theme(legend.title=element_blank())

#revenue<- revenue+
 #  facet_wrap(~ Adjusted, scales = "free_y", ncol=2)
  
#ggplotly(revenue)
```




